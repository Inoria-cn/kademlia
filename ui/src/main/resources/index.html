<!DOCTYPE html>
<html ng-app="ui">
    <head>
        <title>VoIP</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap-theme.min.css">
        <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">

        <!-- This is version 1.2 of firebug lite, newer versions do not work unless used with external urls (browser/JS security feature)? Taken from http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js -->
        <!-- http://stackoverflow.com/questions/17387981/javafx-webview-webengine-firebuglite-or-some-other-debugger -->
        <script src="js/firebug-lite.js"></script>

        <script src="js/jquery-2.1.4.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/angular.min.js"></script>
        <script src="js/script.js"></script>
    </head>
    <body ng-controller="MainCtrl">

        <!-- LOGIN SCREEN -->
        <div id="loginScreen" class="voip-screen-centered" ng-show="state === 'LOGIN'">
            <div class="container-fluid">
                <div id="logo">
                    <span class="fa-stack fa-5x">
                        <i class="fa fa-cloud fa-stack-2x"></i>
                        <i class="fa fa-phone fa-stack-1x fa-inverse"></i>
                    </span>
                </div>

                <div class="panel panel-danger" ng-show="errorMessage !== ''">
                    <div class="panel-heading">
                        <span><i class="fa fa-exclamation-circle fa-fw text-danger"></i>Error</span>
                    </div>
                    <div class="panel-body">
                        <span class="text-danger">{{errorMessage}}</span>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12 form-group">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-user fa-fw"></i></span>
                            <input class="form-control" type="text" placeholder="Username" id="loginUsername" ng-model="loginUsername">
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xs-12 form-group">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-exchange fa-fw"></i></span>
                            <input class="form-control" type="text" placeholder="Bootstrap Host:Port (leave empty if you're the first node in the network)" id="loginBootstrap" ng-model="loginBootstrap">
                        </div>
                    </div>
                </div>
            </div>

            <div class="container-fluid">
                <div class="row">
                    <div class="col-xs-12">
                        <button id="connect-button" class="col-xs-12 btn btn-primary btn-lg" ng-click="loginAction()">Connect</button>
                    </div>
                </div>
            </div>
        </div>


        <!-- WORKING SCREEN -->
        <div id="workingScreen" class="voip-screen-centered" ng-show="state === 'WORKING'">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-xs-12 emblem-important">
                        <i id="working-spinner" class="fa fa-circle-o-notch fa-spin fa-5x"></i>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12">
                        <p class="text-important">{{workingMessage}}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- HARD ERROR -->
        <div id="hardErrorScreen" class="voip-screen-centered" ng-show="state === 'UNRECOVERABLE_ERROR'">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-xs-12 emblem-important">
                        <span class="text-danger"><i class="fa fa-warning fa-5x"></i></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12">
                        <p class="text-important">{{unrecoverableErrorMessage}}</p>
                    </div>
                </div>
            </div>
        </div>


        <!-- LOGGED IN SCREEN -->
        <div id="loggedInScreen" class="voip-screen-centered" ng-show="state.indexOf('ACTIVE_') === 0">

            <!-- MENU -->
            <div id="loggedInScreenMenu" class="menu" ng-show="state === 'ACTIVE_IDLE'">
                <nav role="navigation" class="navbar navbar-default navbar-fixed-top">
                    <div class="container-fluid">
                        <div class="navbar-header">
                            <button type="button" data-target="#navbarCollapse" data-toggle="collapse" class="navbar-toggle">
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            <a href="#" class="navbar-brand">{{loginUsername}}</a>
                        </div>
                        <div id="navbarCollapse" class="collapse navbar-collapse">
                            <ul class="nav navbar-nav">
                            </ul>
                            <ul class="nav navbar-nav navbar-right">
                                <li><a href="#" ng-click="resetDevicesAction()">Configure Audio</a></li>
                                <li><a href="#" ng-click="logoutAction()">Disconnect</a></li>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>

            <!-- ENTRY POINT -->
            <div id="loggedInScreenEntryPoint" class="chunk" ng-show="state === 'ACTIVE_IDLE'">
                <div class="container-fluid">
                    <p class="text-important">Who would you like to call?</p>
                </div>
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-10 form-group">
                            <div class="input-group">
                                <span class="input-group-addon"><i class="fa fa-user fa-fw"></i></span>
                                <input class="form-control" type="text" placeholder="Username" id="callUsername" ng-model="callUsername">
                            </div>
                        </div>

                        <div class="col-sm-2 form-group">
                            <button class="btn btn-primary" id="callButton" ng-click="callAction()">
                                <i class="fa fa-phone fa-fw fa-1x"></i>
                                Call
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CONTACTING -->
            <div id="loggedInScreenConnecting" class="chunk" ng-show="state === 'ACTIVE_OUTGOING_CALLING'">
                <div class="container-fluid">
                    <div class="callLogo">
                        <i class="fa fa-user fa-2x"></i>
                        <i class="fa fa-exchange fa-2x"></i>
                        <span class="fa-stack fa-2x">
                            <i class="fa fa-cloud fa-stack-2x"></i>
                            <i class="fa fa-phone fa-stack-1x fa-inverse"></i>
                        </span>
                        <i class="fa fa-exchange fa-2x"></i>
                        <i class="fa fa-user fa-2x"></i>
                    </div>
                    <p class="text-important">Calling {{callUsername}}</p>
                </div>
            </div>

            <!-- CONNECTED -->
            <div id="loggedInScreenConnected" class="chunk" ng-show="state === 'ACTIVE_IN_CALL'">
                <div class="container-fluid">
                    <div class="emblem-important">
                        <i class="fa fa-user fa-2x"></i>
                        <i class="fa fa-exchange fa-2x"></i>
                        <span class="fa-stack fa-2x">
                            <i class="fa fa-cloud fa-stack-2x"></i>
                            <i class="fa fa-phone fa-stack-1x fa-inverse"></i>
                        </span>
                        <i class="fa fa-exchange fa-2x"></i>
                        <i class="fa fa-user fa-2x"></i>
                    </div>
                    <p class="text-important">CONNECTED WITH USERNAME</p>
                </div>
                <div class="container-fluid">
                    <button id="connected-end-button" class="btn btn-lg btn-danger btn-block">
                        <i class="fa fa-close fa-1x"></i>
                        Hangup
                    </button>
                </div>
            </div>

            <!-- INCOMING CALL -->
            <div id="loggedInScreenContacted" class="chunk" ng-show="state === 'ACTIVE_INCOMING_CALL'">
                <div class="container-fluid">
                    <div class="callLogo">
                        <i class="fa fa-user fa-2x"></i>
                        <i class="fa fa-exchange fa-2x"></i>
                        <span class="fa-stack fa-2x">
                            <i class="fa fa-cloud fa-stack-2x"></i>
                            <i class="fa fa-phone fa-stack-1x fa-inverse"></i>
                        </span>
                        <i class="fa fa-exchange fa-2x"></i>
                        <i class="fa fa-user fa-2x"></i>
                    </div>
                    <p class="text-important">Call from {{callUsername}}</p>
                    <div class="row">
                        <div class="col-xs-12 btn-group">
                            <button type="button" class="col-xs-6 btn btn-danger btn-lg" data-dismiss="modal">
                                <i class="fa fa-close fa-fw fa-1x"></i>
                                Reject
                            </button>
                            <button type="button" class="col-xs-6 btn btn-success btn-lg" data-dismiss="modal">
                                <i class="fa fa-check fa-fw fa-1x"></i>
                                Accept
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- NETWORK ACTIVITY INDICATOR -->
            <div class="container-fluid" id="network-activity">
                <span id="network-activity-header" class="text-uppercase text-muted small lead">Network Activity</span><br>
                <span id="network-activity-data" class="text-muted small">
                    {{inMessageRate}} incoming messages/sec<br>
                    {{outMessageRate}} outgoing messages/sec
                </span>
            </div>
        </div>

        <!-- DEVICE SELECTION -->
        <div class="voip-screen-centered" ng-show="state === 'DEVICE_SELECTION'">
            <div class="container-fluid">
                <div class="panel panel-info">
                    <div class="panel-body">
                        <i class="fa fa-info-circle fa-fw fa-2x text-info"></i>
                        <span class="text-info">
                            If your selections are correct, you should be able to hear yourself speaking.
                        </span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="audio-input-select">Audio Input Device</label>
                    <select class="form-control" id="audio-input-select" name="audio-input" ng-model="selectedInputDevice" ng-options="key as value for (key , value) in inputDevices" ng-change="chooseDevicesAction()">
                    </select>
                </div>
                <div class="form-group">
                    <label for="audio-output-select">Audio Output Device</label>
                    <select class="form-control" id="audio-output-select"  name="audio-output" ng-model="selectedOutputDevice" ng-options="key as value for (key , value) in outputDevices"  ng-change="chooseDevicesAction()">
                    </select>
                </div>
                <button type="button" class="btn btn-primary btn-block" ng-click="devicesChosenAction()">Done</button>
            </div>
        </div>
    </body>
</html>